(()=>{var e={};e.id=751,e.ids=[751],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4751:(e,t,r)=>{"use strict";r.d(t,{Se:()=>s});let a="/api/v1",s={AUTH:{SIGN_UP:`${a}/auth/signup`},CREATOR:{UPLOAD_POST:`${a}/creator/upload-post`},MEDIA:{UPLOAD_POST:`${a}/creator/upload-post`,FEED:`${a}/media/feed`,LIKE:`${a}/media/like`,SEARCH:`${a}/media/search`,COMMENT:`${a}/media/comment`}}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10911:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(60687),s=r(43210),i=r(45011),l=r(75535),o=r(51060),n=r(4751);let d=async(e,t={})=>o.A.get(e,{params:t});var c=r(88597);let m=()=>(0,a.jsx)("div",{className:"space-y-6 max-w-xl mx-auto",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsxs)("div",{className:"animate-pulse bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"w-full h-64 sm:h-72 md:h-80 bg-gray-300 dark:bg-gray-700 rounded mb-4"}),(0,a.jsx)("div",{className:"h-5 bg-gray-300 dark:bg-gray-600 rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-600 rounded w-1/2 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3"})]},t))}),u=()=>{let[e,t]=(0,s.useState)(!0),[r,u]=(0,s.useState)([]),[p,x]=(0,s.useState)({}),[h,b]=(0,s.useState)({}),[g,y]=(0,s.useState)(null),[f,v]=(0,s.useState)(!1),w=(0,s.useRef)(),[j,N]=(0,s.useState)({}),[k,S]=(0,s.useState)({}),[C,P]=(0,s.useState)(""),[A,D]=(0,s.useState)(!1),_=async(e,t,r=null)=>{let a=(0,l.P)((0,l.rJ)(i.db,"media",e,"comments",t,"replies"),(0,l.My)("createdAt","desc"),...r?[(0,l.HM)(r)]:[],(0,l.AB)(3)),s=await (0,l.GG)(a);return{replies:s.docs.map(e=>({id:`${t}-${e.id}`,...e.data()})),last:s.docs[s.docs.length-1]}},q=async(e,t=null)=>{let r=(0,l.P)((0,l.rJ)(i.db,"media",e,"comments"),(0,l.My)("createdAt","desc"),...t?[(0,l.HM)(t)]:[],(0,l.AB)(3)),a=await (0,l.GG)(r);return{comments:await Promise.all(a.docs.map(async t=>{let r={id:t.id,...t.data()},{replies:a,last:s}=await _(e,r.id);return S(e=>({...e,[r.id]:s})),r.replies=a,r})),last:a.docs[a.docs.length-1]}},E=async(e=!1)=>{try{e||t(!0);let r=await o.A.get(`${n.Se.MEDIA.FEED}`,{params:e&&g?{cursor:g}:{}}),a=await Promise.all(r.data.data.map(async e=>{let{comments:t,last:r}=await q(e.id);return N(t=>({...t,[e.id]:r})),{...e,comments:t}}));u(e=>{let t=new Set(e.map(e=>e.id));return[...e,...a.filter(e=>!t.has(e.id))]}),y(r.data.nextCursor)}catch(e){console.error("Failed to fetch media:",e)}finally{e||t(!1)}},M=async e=>{if(!e.trim())return E();D(!0);try{let t=await d(n.Se.MEDIA.SEARCH,{term:e}),r=await Promise.all(t.data.data.map(async e=>{let{comments:t,last:r}=await q(e.id);return N(t=>({...t,[e.id]:r})),{...e,comments:t}}));u(r)}catch(e){console.error("Search failed:",e)}finally{D(!1)}},$=async e=>{let t=[...r],a=r.find(t=>t.id===e),s=a?.likes||0;u(t=>t.map(t=>t.id===e?{...t,likes:s+1}:t));try{let{newLikes:t}=(await o.A.post("/api/v1/media/like",{mediaId:e})).data;u(r=>r.map(r=>r.id===e?{...r,likes:t}:r))}catch(e){console.error("Failed to like media:",e),u(t)}};(0,s.useEffect)(()=>{E()},[]),(0,s.useEffect)(()=>{let e=new IntersectionObserver(e=>{e[0].isIntersecting&&g&&!f&&!A&&(v(!0),E(!0).then(()=>v(!1)))});return w.current&&e.observe(w.current),()=>e.disconnect()},[g,f,A]);let F=async e=>{let t=j[e];try{let r=(0,l.P)((0,l.rJ)(i.db,"media",e,"comments"),(0,l.My)("createdAt","desc"),...t?[(0,l.HM)(t)]:[],(0,l.AB)(3)),a=await (0,l.GG)(r),s=await Promise.all(a.docs.map(async t=>{let r={id:t.id,...t.data()},{replies:a,last:s}=await _(e,t.id);return S(e=>({...e,[t.id]:s})),{...r,replies:a}}));u(t=>t.map(t=>{if(t.id!==e)return t;let r=new Set(t.comments.map(e=>e.id)),a=s.filter(e=>!r.has(e.id));return{...t,comments:[...t.comments,...a]}}));let o=a.docs[a.docs.length-1];o&&N(t=>({...t,[e]:o}))}catch(e){console.error("Failed to load more comments:",e)}},z=async(e,t)=>{let r=k[t],{replies:a,last:s}=await _(e,t,r);u(r=>r.map(r=>r.id===e?{...r,comments:r.comments.map(e=>e.id===t?{...e,replies:[...e.replies,...a]}:e)}:r)),S(e=>({...e,[t]:s}))},I=async e=>{let t=p[e];if(!t)return;let r={text:t,userId:i.j.currentUser.uid,displayName:i.j.currentUser.displayName,createdAt:new Date},a=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;u(t=>t.map(t=>t.id===e?{...t,comments:[{id:a,...r,replies:[]},...t.comments]}:t));try{await (0,c.L)(n.Se.MEDIA.COMMENT,{mediaId:e,comment:r})}catch(e){console.error("Failed to submit comment:",e)}x({...p,[e]:""})},G=async(e,t)=>{let r=h[t];if(!r)return;let a={text:r,userId:i.j.currentUser.uid,displayName:i.j.currentUser.displayName,createdAt:new Date},s=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;u(r=>r.map(r=>r.id===e?{...r,comments:r.comments.map(e=>e.id===t?{...e,replies:[...e.replies,{id:s,...a}]}:e)}:r)),await (0,l.gS)((0,l.rJ)(i.db,"media",e,"comments",t,"replies"),{...a,createdAt:(0,l.O5)()}),b({...h,[t]:""})},O=e=>{try{let t=e&&"object"==typeof e&&e.toDate?e.toDate():new Date(e);if(isNaN(t.getTime()))return"";return new Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"short"}).format(t)}catch(t){return console.error("Invalid timestamp:",e),""}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6 max-w-xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Media Feed"}),(0,a.jsx)("div",{className:"bg-yellow-100 text-yellow-800 text-sm font-semibold px-4 py-1 rounded-full dark:bg-yellow-800 dark:text-yellow-100",children:"Consumer Mode"})]}),(0,a.jsx)("p",{className:"text-center text-xs text-gray-500 dark:text-gray-400 mb-4",children:"You canâ€™t upload content from here."}),(0,a.jsxs)("div",{className:"max-w-xl mx-auto mb-6 space-y-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search by title or location...",value:C,onChange:e=>P(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>M(C),className:"flex-1 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-semibold",children:"Search"}),C&&(0,a.jsx)("button",{onClick:()=>{P(""),E()},className:"flex-1 py-2 rounded bg-gray-500 hover:bg-gray-600 text-white font-semibold",children:"Clear"})]})]}),(0,a.jsxs)("div",{className:"space-y-10 max-w-xl mx-auto",children:[e?(0,a.jsx)(m,{}):r.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:["video"===e.type?(0,a.jsx)("div",{className:"w-full h-64 sm:h-72 md:h-80 overflow-hidden rounded-lg bg-black",children:(0,a.jsx)("video",{src:e.url,controls:!0,className:"w-full h-full object-cover"})}):(0,a.jsx)("div",{className:"w-full h-64 sm:h-72 md:h-80 overflow-hidden rounded-lg bg-gray-300 dark:bg-gray-700",children:(0,a.jsx)("img",{src:e.url,alt:e.title,className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Posted by ",e.displayName||"Unknown"," \xb7"," ",O(e.createdAt)]}),e.location&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["\uD83D\uDCCD ",e.location]}),e.people&&e.people.length>0&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["\uD83D\uDC65 With: ",e.people.join(", ")]}),(0,a.jsxs)("button",{onClick:()=>$(e.id),className:"mt-2 text-blue-600 text-sm font-medium hover:underline",children:["\uD83D\uDC4D Like (",e.likes||0,")"]}),(0,a.jsxs)("div",{className:"mt-4 space-y-4",children:[e.comments.map(t=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:[(0,a.jsxs)("span",{className:"font-semibold",children:[t.displayName,":"]})," ",t.text,(0,a.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:O(t.createdAt)})]}),(0,a.jsxs)("div",{className:"ml-4 mt-2 space-y-2 border-l border-gray-300 dark:border-gray-600 pl-4",children:[t.replies.map(e=>(0,a.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.displayName,":"]})," ",e.text,(0,a.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:O(e.createdAt)})]},`${t.id}-${e.id}`)),k[t.id]&&(0,a.jsx)("button",{onClick:()=>z(e.id,t.id),className:"text-sm text-blue-500 hover:underline",children:"Load more replies"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{value:h[t.id]||"",onChange:e=>b({...h,[t.id]:e.target.value}),placeholder:"Write a reply...",className:"w-full text-sm px-2 py-1 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,a.jsx)("button",{onClick:()=>G(e.id,t.id),className:"text-blue-600 text-sm font-medium",children:"Reply"})]})]})]},`${e.id}-${t.id}`)),j[e.id]&&(0,a.jsx)("button",{onClick:()=>F(e.id),className:"text-sm text-blue-500 hover:underline",children:"Load more comments"})]}),(0,a.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,a.jsx)("input",{value:p[e.id]||"",onChange:t=>x({...p,[e.id]:t.target.value}),placeholder:"Write a comment...",className:"w-full text-sm px-2 py-1 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,a.jsx)("button",{onClick:()=>I(e.id),className:"text-blue-600 text-sm font-medium",children:"Post"})]})]})]},e.id)),!e&&!A&&(0,a.jsx)("div",{ref:w,className:"h-10"})]})]})}},12412:e=>{"use strict";e.exports=require("assert")},12847:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=r(65239),s=r(48088),i=r(88170),l=r.n(i),o=r(30893),n={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);r.d(t,n);let d={children:["",{children:["(protected)",{children:["media",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,38387)),"F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\(protected)\\media\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58079)),"F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\(protected)\\layout.jsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,83970)),"F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\(protected)\\media\\page.jsx"],m={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(protected)/media/page",pathname:"/media",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},14985:e=>{"use strict";e.exports=require("dns")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},38387:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"F:\\\\fiverr\\\\faizanYounas\\\\scalableSoftwareSolutions\\\\scalableCode\\\\next_scalable\\\\src\\\\app\\\\(protected)\\\\media\\\\page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\(protected)\\media\\page.jsx","default")},43970:(e,t,r)=>{Promise.resolve().then(r.bind(r,10911))},51361:(e,t,r)=>{Promise.resolve().then(r.bind(r,58079))},54647:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58079:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"F:\\\\fiverr\\\\faizanYounas\\\\scalableSoftwareSolutions\\\\scalableCode\\\\next_scalable\\\\src\\\\app\\\\(protected)\\\\layout.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"F:\\fiverr\\faizanYounas\\scalableSoftwareSolutions\\scalableCode\\next_scalable\\src\\app\\(protected)\\layout.jsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64513:(e,t,r)=>{Promise.resolve().then(r.bind(r,93917))},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(31658);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},75514:(e,t,r)=>{Promise.resolve().then(r.bind(r,38387))},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},88597:(e,t,r)=>{"use strict";r.d(t,{L:()=>s});var a=r(51060);let s=async(e,t)=>{try{return(await a.A.post(e,t)).data}catch(t){throw console.error(`POST ${e} failed:`,t),t}}},91645:e=>{"use strict";e.exports=require("net")},93917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(60687),s=r(43210),i=r(16189),l=r(65553),o=r(45011);let n=({children:e})=>{let t=(0,i.useRouter)(),[r,n]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=(0,l.hg)(o.j,e=>{e?c(e):t.push("/auth/signin"),n(!1)});return()=>e()},[t]),r)?(0,a.jsx)("div",{className:"p-4",children:"Loading..."}):(0,a.jsx)(a.Fragment,{children:e})}},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[719,515,658,60,222],()=>r(12847));module.exports=a})();